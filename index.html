<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Wisuda 2026 - Raudlatul Firdaus</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0f172a;
            --secondary: #10b981;
            --accent: #facc15;
            --danger: #ef4444;
            --glass: rgba(255, 255, 255, 0.95);
            --bg: #f8fafc;
        }

        * { font-family: 'Plus Jakarta Sans', sans-serif; box-sizing: border-box; }
        body { background-color: var(--bg); margin: 0; color: #1e293b; line-height: 1.6; }

        /* --- PORTAL --- */
        #halaman-portal {
            min-height: 100vh; display: flex; justify-content: center; align-items: center;
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 100%);
            position: relative; overflow: hidden; padding: 20px;
        }
        #halaman-portal::before {
            content: ""; position: absolute; width: 200%; height: 200%;
            background-image: url('https://www.transparenttextures.com/patterns/islamic-art.png');
            opacity: 0.1; animation: rotate 100s linear infinite;
        }
        @keyframes rotate { from {transform: rotate(0deg);} to {transform: rotate(360deg);} }

        .portal-box {
            position: relative; z-index: 10; background: var(--glass);
            padding: 40px 30px; border-radius: 24px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
            max-width: 550px; width: 100%; text-align: center; border: 1px solid rgba(255,255,255,0.3);
        }

        .logo-main { width: 110px; height: 110px; object-fit: contain; margin-bottom: 15px; }
        .logo-sub { width: 75px; height: 75px; object-fit: contain; background: white; border: 2px solid #f1f5f9; padding: 5px; border-radius: 15px; }
        .logo-header { width: 35px; height: 35px; object-fit: contain; border-radius: 6px; background: white; }

        .text-title { color: var(--primary); font-weight: 800; margin: 0; line-height: 1.2; font-size: 1.4em; text-transform: uppercase; }
        .text-subtitle { color: #64748b; font-size: 0.9em; margin: 10px 0 25px; font-weight: 500; }
        .program-label { background: #f1f5f9; padding: 5px 12px; border-radius: 8px; font-size: 0.75em; font-weight: 700; color: var(--primary); display: inline-block; margin-bottom: 20px; border: 1px solid #e2e8f0; }

        /* --- UI COMPONENTS --- */
        header { background: var(--primary); color: white; padding: 15px; text-align: center; border-bottom: 4px solid var(--accent); }
        nav { background: white; display: flex; justify-content: center; gap: 5px; padding: 10px; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.05); overflow-x: auto; }
        nav button { border: none; background: none; padding: 10px 15px; font-weight: 600; color: #64748b; cursor: pointer; border-radius: 10px; transition: 0.3s; white-space: nowrap; font-size: 0.8em; }
        nav button.active { background: #eff6ff; color: var(--primary); }

        .container { max-width: 850px; margin: 20px auto; padding: 0 20px; }
        .card { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); margin-bottom: 20px; border: 1px solid #f1f5f9; }
        h2 { font-size: 1.1em; color: var(--primary); margin-top: 0; display: flex; align-items: center; gap: 10px; }

        .btn { padding: 14px 20px; border-radius: 12px; border: none; font-weight: 700; cursor: pointer; transition: 0.3s; font-size: 0.9em; display: inline-flex; align-items: center; justify-content: center; gap: 8px; width: 100%; }
        .btn-primary { background: var(--secondary); color: white; }
        .btn-accent { background: var(--accent); color: var(--primary); }
        
        .form-group { margin-bottom: 15px; text-align: left; }
        label { display: block; font-size: 0.8em; font-weight: 700; color: #475569; margin-bottom: 5px; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #e2e8f0; border-radius: 10px; background: #f8fafc; font-size: 0.9em; }

        table { width: 100%; border-collapse: collapse; font-size: 0.85em; }
        th { text-align: left; padding: 12px; background: #f8fafc; border-bottom: 2px solid #e2e8f0; color: #64748b; }
        td { padding: 12px; border-bottom: 1px solid #f1f5f9; }

        .badge { padding: 5px 12px; border-radius: 20px; font-size: 0.7em; font-weight: 700; text-transform: uppercase; }
        .bg-lunas { background: #dcfce7; color: #15803d; }
        .bg-cicil { background: #fef3c7; color: #b45309; }
        .bg-belum { background: #fee2e2; color: #b91c1c; }

        .admin-only { display: none; }
    </style>
</head>
<body>

<div id="halaman-portal">
    <div class="portal-box">
        <img src="1650288985432.jpg" class="logo-main dynamic-logo-utama">
        
        <p class="program-label">PONDOK PESANTREN RAUDLATUL FIRDAUS</p>
        <h1 class="text-title">SISTEM WISUDA 2026</h1>
        <p class="text-subtitle">Program Kursus Yanbu'a dan Al-Iktisyaf</p>
        
        <div style="display: flex; justify-content: center; gap: 20px; margin-bottom: 30px;">
            <div style="text-align: center;">
                <img src="YRF.jpg" class="logo-sub dynamic-logo-yrf">
                <p style="font-size: 10px; font-weight: bold; margin-top: 5px;">YANBU'A</p>
            </div>
            <div style="text-align: center;">
                <img src="GENSAI.jpg" class="logo-sub dynamic-logo-gensai">
                <p style="font-size: 10px; font-weight: bold; margin-top: 5px;">AL-IKTISYAF</p>
            </div>
        </div>

        <button class="btn" onclick="masukSebagai('TAMU')" style="background: white; color: var(--primary); border: 2px solid #f1f5f9; margin-bottom: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">üîì MASUK SEBAGAI TAMU</button>
        <button class="btn btn-accent" onclick="bukaLogin()">üîí LOGIN ADMINISTRATOR</button>
    </div>
</div>

<div id="modal-login" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(15, 23, 42, 0.8); z-index:1000; justify-content:center; align-items:center; backdrop-filter: blur(8px);">
    <div class="card" style="width:350px; margin:0; text-align: center; border: 2px solid var(--accent);">
        <img src="1650288985432.jpg" class="dynamic-logo-utama" style="width: 80px; margin-bottom: 15px;">
        <h3 style="margin: 0;">Login Admin</h3>
        <p style="font-size: 0.75em; color: #64748b; margin-bottom: 20px;">PP. Raudlatul Firdaus</p>
        <div class="form-group"><input type="text" id="userAdmin" placeholder="Username"></div>
        <div class="form-group"><input type="password" id="passAdmin" placeholder="Password"></div>
        <button class="btn btn-primary" onclick="cekLogin()">VERIFIKASI</button>
        <button onclick="tutupLogin()" style="background:none; border:none; color:#94a3b8; margin-top:15px; cursor:pointer; font-size: 0.85em; font-weight: 600;">Kembali</button>
    </div>
</div>

<div id="halaman-utama" style="display:none;">
    <header>
        <div style="display:flex; align-items:center; justify-content:center; gap:12px;">
            <img src="1650288985432.jpg" class="dynamic-logo-utama logo-header">
            <div style="text-align:left;">
                <h4 style="margin:0; font-size:0.85em; letter-spacing:1px;">RAUDLATUL FIRDAUS 2026</h4>
                <p id="user-status" style="margin:0; font-size:0.6em; color:var(--accent); font-weight:700; text-transform:uppercase;"></p>
            </div>
        </div>
    </header>

    <nav>
        <button class="nav-btn active" onclick="showSec('sec-ann', this)">üì¢ INFO</button>
        <button class="nav-btn" onclick="showSec('sec-rekap', this)">üìä DATA</button>
        <button class="nav-btn admin-only" onclick="showSec('sec-input', this)">üìù INPUT</button>
        <button class="nav-btn admin-only" onclick="showSec('sec-pay', this)">üí∞ BAYAR</button>
        <button class="nav-btn admin-only" onclick="showSec('sec-logo', this)">‚öôÔ∏è LOGO</button>
        <button class="nav-btn" onclick="showSec('sec-call', this)">üìû KONTAK</button>
        <button onclick="location.reload()" style="color:var(--danger); font-size: 1.2em;">üö™</button>
    </nav>

    <div class="container">
        <div id="sec-logo" class="section admin-only" style="display:none;">
            <div class="card">
                <h2>‚öôÔ∏è Manajemen Logo & Branding</h2>
                <div class="form-group">
                    <label>Logo Pesantren (Utama):</label>
                    <input type="file" accept="image/*" onchange="uploadFile(this, 'logoUtama')">
                </div>
                <div class="form-group">
                    <label>Logo Program Yanbu'a:</label>
                    <input type="file" accept="image/*" onchange="uploadFile(this, 'logoYrf')">
                </div>
                <div class="form-group">
                    <label>Logo Program Al-Iktisyaf:</label>
                    <input type="file" accept="image/*" onchange="uploadFile(this, 'logoGensai')">
                </div>
                <button class="btn btn-primary" onclick="location.reload()">üíæ SIMPAN PERUBAHAN</button>
            </div>
        </div>

        <div id="sec-ann" class="section">
            <div class="card">
                <h2>üì¢ Informasi Terkini</h2>
                <div id="viewPengumuman" style="background:#fefce8; padding:20px; border-radius:15px; border-left:5px solid var(--accent); font-size:0.95em; color: #854d0e;"></div>
                <div class="admin-only" style="margin-top:20px;">
                    <label>Edit Pengumuman:</label>
                    <textarea id="editPengumuman" rows="4"></textarea>
                    <button class="btn btn-primary" onclick="simpanInfo('ann_v5', 'editPengumuman')" style="margin-top:10px;">PUBLIKASIKAN</button>
                </div>
            </div>
        </div>

        <div id="sec-rekap" class="section" style="display:none;">
            <div class="card">
                <h2>üìä Rekapitulasi Peserta Wisuda</h2>
                <div style="overflow-x:auto; border-radius: 12px; border: 1px solid #e2e8f0;">
                    <table>
                        <thead><tr><th>Nama Santri</th><th>Alamat</th><th>Predikat</th></tr></thead>
                        <tbody id="bodyRekap"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="sec-input" class="section admin-only" style="display:none;">
            <div class="card">
                <h2>üìù Manajemen Data Santri</h2>
                <button class="btn" onclick="downloadExcel()" style="background:#065f46; color:white; margin-bottom:20px;">üì• EXPORT KE EXCEL (.XLSX)</button>
                <div class="form-group"><label>Pilih Santri:</label><select id="selNama" onchange="isiForm()"></select></div>
                <div class="form-group"><label>Alamat Domisili:</label><input type="text" id="f_alamat"></div>
                <div class="form-group"><label>Tempat, Tanggal Lahir:</label><input type="text" id="f_ttl"></div>
                <div class="form-group"><label>Nama Ayah:</label><input type="text" id="f_ayah"></div>
                <div class="form-group"><label>Nama Ibu:</label><input type="text" id="f_ibu"></div>
                <div class="form-group"><label>Predikat Kelulusan:</label><select id="f_predikat"><option>Mumtaz</option><option>Jayyid Jiddan</option><option>Jayyid</option></select></div>
                <button class="btn btn-primary" onclick="simpanSantri()">SIMPAN DATA</button>
            </div>
        </div>

        <div id="sec-pay" class="section admin-only" style="display:none;">
            <div class="card">
                <h2>üí∞ Monitoring Administrasi</h2>
                <div class="form-group"><label>Pilih Santri:</label><select id="payNama"></select></div>
                <div class="form-group"><label>Jumlah Bayar (Rp):</label><input type="number" id="payNominal"></div>
                <div class="form-group"><label>Status:</label><select id="payStat"><option value="Belum">Belum Lunas</option><option value="Cicil">Cicil</option><option value="Lunas">Lunas</option></select></div>
                <button class="btn btn-primary" onclick="simpanBayar()">UPDATE STATUS</button>
                <div style="overflow-x:auto; margin-top:25px; border: 1px solid #e2e8f0; border-radius: 12px;">
                    <table>
                        <thead><tr><th>Nama</th><th>Status Pembayaran</th></tr></thead>
                        <tbody id="bodyPay"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="sec-call" class="section" style="display:none;">
            <div class="card">
                <h2>üìû Hubungi Panitia</h2>
                <div style="display:grid; gap:12px;">
                    <a href="https://wa.me/6285651426435" style="text-decoration:none; color:inherit; padding:15px; background:#f8fafc; border-radius:12px; border:1px solid #e2e8f0; display:flex; justify-content: space-between; align-items: center;">
                        <div><strong>Ust. Ridha Kurniawan</strong><br><small style="color: #64748b;">Pendaftaran & Berkas</small></div>
                        <span style="color: var(--secondary); font-weight: bold;">WhatsApp &rsaquo;</span>
                    </a>
                    <a href="https://wa.me/6282253267650" style="text-decoration:none; color:inherit; padding:15px; background:#f8fafc; border-radius:12px; border:1px solid #e2e8f0; display:flex; justify-content: space-between; align-items: center;">
                        <div><strong>Ust. Lukman Hakim</strong><br><small style="color: #64748b;">Administrasi & Keuangan</small></div>
                        <span style="color: var(--secondary); font-weight: bold;">WhatsApp &rsaquo;</span>
                    </a>
                </div>
                
                <h3 style="margin-top:30px; font-size:1.1em; color: var(--primary);">üì© Form Pengaduan Online</h3>
                <form action="https://formsubmit.co/lukmanhakim2305006@gmail.com" method="POST">
                    <input type="text" name="Nama" placeholder="Nama Lengkap Wali Murid" required style="margin-bottom:10px;">
                    <textarea name="Pesan" placeholder="Tuliskan pesan atau kendala Anda di sini..." rows="4" required style="margin-bottom:15px;"></textarea>
                    <button type="submit" class="btn btn-primary">KIRIM PESAN KE EMAIL</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    const nDefault = ["Ahmad Akmal Ramadhan", "Ahmad Waris Zaini", "Arya Fakhri Arta Rayhan", "Azriel Maulana", "Dimas Prayoga", "Faisal Mukhtar", "Khairul Imam", "Muh. Alif Junirwansyah", "Muh. Lutfi Adrian", "Muh. Rizki Tatjumuddin", "Muh. Rofiq Alfiansyah", "Muh. Syamsul Arifin Ilham", "Muhammad Abai Suni", "Muhammad Abdul Aziz", "Muhammad Ridwan", "Muhammad Ridwan", "Muhammad Riski", "Muhammad Riski Adiya", "Raihan Agus Salim", "Rayyan Ainurrahman", "Ridwan", "Riski Arya Faizal", "Rudi Ansyah", "Yusril Pratama Juliansyah", "Ahmad Farid", "Bima Aditya al-Farez", "Muhammad Albi", "Muhammad Farhan Arrobi", "Rohim"];

    let db = JSON.parse(localStorage.getItem('db_wisuda_v8')) || nDefault.map(n => ({
        nama: n, alamat: '-', ttl: '-', ayah: '-', ibu: '-', predikat: 'Jayyid', nominal: 0, status: 'Belum'
    }));

    function uploadFile(input, key) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) { localStorage.setItem(key, e.target.result); alert("Logo terunggah! Silakan klik Simpan."); }
            reader.readAsDataURL(input.files[0]);
        }
    }

    function applyLogos() {
        const u = localStorage.getItem('logoUtama');
        const y = localStorage.getItem('logoYrf');
        const g = localStorage.getItem('logoGensai');
        if(u) document.querySelectorAll('.dynamic-logo-utama').forEach(el => el.src = u);
        if(y) document.querySelectorAll('.dynamic-logo-yrf').forEach(el => el.src = y);
        if(g) document.querySelectorAll('.dynamic-logo-gensai').forEach(el => el.src = g);
    }

    function bukaLogin() { document.getElementById('modal-login').style.display = 'flex'; }
    function tutupLogin() { document.getElementById('modal-login').style.display = 'none'; }
    
    function cekLogin() {
        if(document.getElementById('userAdmin').value === 'pondok2026' && document.getElementById('passAdmin').value === 'raufir2026') {
            masukSebagai('ADMIN'); tutupLogin();
        } else { alert("Akses Ditolak! Cek Username/Password."); }
    }

    function masukSebagai(m) {
        document.getElementById('halaman-portal').style.display = 'none';
        document.getElementById('halaman-utama').style.display = 'block';
        document.getElementById('user-status').innerText = "MODE: " + m;
        if(m === 'ADMIN') document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'block');
        applyLogos();
        render();
    }

    function showSec(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).style.display = 'block';
        btn.classList.add('active');
    }

    function render() {
        const bRekap = document.getElementById('bodyRekap');
        const bPay = document.getElementById('bodyPay');
        const sNama = document.getElementById('selNama');
        const pNama = document.getElementById('payNama');
        bRekap.innerHTML = ''; bPay.innerHTML = ''; 
        sNama.innerHTML = '<option value="">-- Pilih Nama Santri --</option>';
        pNama.innerHTML = '<option value="">-- Pilih Nama Santri --</option>';

        db.forEach((s, i) => {
            bRekap.innerHTML += `<tr><td><strong>${s.nama}</strong></td><td>${s.alamat}</td><td><span class="badge bg-lunas">${s.predikat}</span></td></tr>`;
            let cl = s.status === 'Lunas' ? 'bg-lunas' : (s.status === 'Cicil' ? 'bg-cicil' : 'bg-belum');
            bPay.innerHTML += `<tr><td>${s.nama}</td><td><span class="badge ${cl}">${s.status}</span></td></tr>`;
            sNama.innerHTML += `<option value="${i}">${s.nama}</option>`;
            pNama.innerHTML += `<option value="${i}">${s.nama}</option>`;
        });
        document.getElementById('viewPengumuman').innerText = localStorage.getItem('ann_v5') || "Belum ada pengumuman resmi.";
    }

    function isiForm() {
        const i = document.getElementById('selNama').value; if(i==="") return;
        document.getElementById('f_alamat').value = db[i].alamat;
        document.getElementById('f_ttl').value = db[i].ttl;
        document.getElementById('f_ayah').value = db[i].ayah;
        document.getElementById('f_ibu').value = db[i].ibu;
        document.getElementById('f_predikat').value = db[i].predikat;
    }

    function simpanSantri() {
        const i = document.getElementById('selNama').value; if(i==="") return;
        db[i] = { ...db[i], alamat: document.getElementById('f_alamat').value, ttl: document.getElementById('f_ttl').value, ayah: document.getElementById('f_ayah').value, ibu: document.getElementById('f_ibu').value, predikat: document.getElementById('f_predikat').value };
        save();
    }

    function simpanBayar() {
        const i = document.getElementById('payNama').value; if(i==="") return;
        db[i].nominal = document.getElementById('payNominal').value;
        db[i].status = document.getElementById('payStat').value;
        save();
    }

    function simpanInfo(k, id) { localStorage.setItem(k, document.getElementById(id).value); alert("Pengumuman diperbarui!"); render(); }
    function save() { localStorage.setItem('db_wisuda_v8', JSON.stringify(db)); alert("Data tersimpan aman!"); render(); }
    function downloadExcel() {
        const ws = XLSX.utils.json_to_sheet(db);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Rekap Wisuda 2026");
        XLSX.writeFile(wb, "Rekap_Wisuda_Raudlatul_Firdaus_2026.xlsx");
    }

    window.onload = applyLogos;
</script>
</body>

</html>
